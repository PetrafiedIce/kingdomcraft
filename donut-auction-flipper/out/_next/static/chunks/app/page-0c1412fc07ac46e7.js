(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8633:function(e,t,l){Promise.resolve().then(l.bind(l,8212))},8212:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return r}});var i=l(7437),n=l(2265);function s(e,t){return 2*Math.min(e,t)}function r(){let[e,t]=(0,n.useState)(""),[l,r]=(0,n.useState)("profit"),[o,a]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(!0),[h,x]=(0,n.useState)([]),[g,p]=(0,n.useState)(!1),[f,b]=(0,n.useState)(null);async function v(){p(!0),b(null);try{if(u||!c)x(function(e){let t=[],l=function(e,l){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t.push({id:"".concat(e,"-").concat(l,"-").concat(t.length),itemName:e,price:l,quantity:i})};for(let e=0;e<50;e++)l("Bone",120+e);for(let e=0;e<50;e++)l("Bonemeal",60+e%5);for(let e=0;e<40;e++)l("Iron Ingot",900+e%50);for(let e=0;e<20;e++)l("Iron Block",9e3+e%100);for(let e=0;e<20;e++)l("Oak Log",200+e%40);return t.slice(0,Math.max(e,50))}(100));else{let e=await fetch("".concat(c),{headers:o?{Authorization:"Bearer ".concat(o),Accept:"application/json"}:{Accept:"application/json"},cache:"no-store"});if(!e.ok)throw Error("Fetch failed: ".concat(e.status));let t=await e.json(),l=Array.isArray(t)?t.map((e,t)=>{var l,i,n,s,r,o,a,c;return{id:String(null!==(l=e.id)&&void 0!==l?l:t),itemName:String(null!==(n=null!==(i=e.itemName)&&void 0!==i?i:e.item)&&void 0!==n?n:"Unknown"),quantity:Number(null!==(s=e.quantity)&&void 0!==s?s:1),price:Number(null!==(o=null!==(r=e.price)&&void 0!==r?r:e.buyout)&&void 0!==o?o:0),seller:null!==(a=e.seller)&&void 0!==a?a:e.owner,createdAt:Number(null!==(c=e.createdAt)&&void 0!==c?c:Date.now())}}):[];x(l)}}catch(t){var e;b(null!==(e=null==t?void 0:t.message)&&void 0!==e?e:"Unknown error")}finally{p(!1)}}(0,n.useEffect)(()=>{let e=localStorage.getItem("donut_api_key"),t=localStorage.getItem("donut_endpoint"),l=localStorage.getItem("donut_use_mock");e&&a(e),t&&d(t),l&&m("true"===l)},[]),(0,n.useEffect)(()=>{v();let e=setInterval(v,2e4);return()=>clearInterval(e)},[o,c,u]);let j=(0,n.useMemo)(()=>(function(e){let t=e.map(e=>({...e,key:e.itemName.toLowerCase().replace(/\s|_|-/g,"")})),l={};for(let e of t)l[e.key]||(l[e.key]=[]),l[e.key].push(e);for(let e in l)l[e].sort((e,t)=>e.price-t.price);let i=[];if(l.bone&&l.bonemeal){let e=l.bone[0],t=l.bonemeal[l.bonemeal.length-1];if(e&&t){let n=e.price,r=3*t.price,o=r-n;o>0&&i.push({id:"bone->bonemeal-".concat(e.id,"-").concat(t.id),itemName:"Bone → Bonemeal x3",strategyLabel:"Crafting arbitrage",buyPrice:n,sellPrice:r,profit:o,roi:o/n,estimatedDailyVolume:s(l.bone.length,l.bonemeal.length),notes:"Buy bones, craft into bonemeal, sell as stacks. Verify recipe and AH fees."})}}if(l.ironingot&&l.ironblock){let e=function(e,t){if(e.length<9)return null;let l=[...e].sort((e,t)=>e.price-t.price),i=0;for(let e=0;e<9;e++)i+=l[e].price;return i}(l.ironingot,0),t=l.ironblock[l.ironblock.length-1];if(null!=e&&t){let n=t.price,r=n-e;r>0&&i.push({id:"iron->block-".concat(t.id),itemName:"Iron Ingot \xd79 → Iron Block",strategyLabel:"Compression arbitrage",buyPrice:e,sellPrice:n,profit:r,roi:r/e,estimatedDailyVolume:s(l.ironingot.length,l.ironblock.length),notes:"Buy ingots, craft blocks, list blocks. Account for crafting time and fees."})}}return i.sort((e,t)=>t.profit-e.profit)})(h),[h]),y=(0,n.useMemo)(()=>{let t=e.trim().toLowerCase();return[...t?j.filter(e=>e.itemName.toLowerCase().includes(t)):j].sort((e,t)=>{var i,n,s,r;return"profit"===l?t.profit-e.profit:"roi"===l?t.roi-e.roi:"volume"===l?(null!==(i=t.estimatedDailyVolume)&&void 0!==i?i:0)-(null!==(n=e.estimatedDailyVolume)&&void 0!==n?n:0):(null!==(s=e.avgTimeToSellSeconds)&&void 0!==s?s:0)-(null!==(r=t.avgTimeToSellSeconds)&&void 0!==r?r:0)})},[j,e,l]);return(0,i.jsxs)("main",{className:"space-y-6",children:[(0,i.jsxs)("section",{className:"card",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-semibold",children:"Best flips right now"}),(0,i.jsx)("p",{className:"text-sm text-muted",children:"Runs completely on this page. Paste your API key/endpoint or use mock data."})]}),(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)("button",{className:"btn btn-ghost",onClick:v,disabled:g,children:g?"Refreshing…":"Refresh"})})]}),(0,i.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:[(0,i.jsxs)("label",{className:"block",children:[(0,i.jsx)("span",{className:"block text-sm text-muted mb-1",children:"API Key (Authorization Bearer)"}),(0,i.jsx)("input",{value:o,onChange:e=>a(e.target.value),placeholder:"Your DonutSMP API key",className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-primary-600"})]}),(0,i.jsxs)("label",{className:"block",children:[(0,i.jsx)("span",{className:"block text-sm text-muted mb-1",children:"Auction Endpoint URL"}),(0,i.jsx)("input",{value:c,onChange:e=>d(e.target.value),placeholder:"https://example/auctions",className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-primary-600"})]}),(0,i.jsxs)("label",{className:"flex items-center gap-2",children:[(0,i.jsx)("input",{type:"checkbox",checked:u,onChange:e=>m(e.target.checked)}),(0,i.jsx)("span",{className:"text-sm",children:"Use mock data"})]}),(0,i.jsx)("div",{children:(0,i.jsx)("button",{className:"btn btn-primary",onClick:function(){localStorage.setItem("donut_api_key",o.trim()),localStorage.setItem("donut_endpoint",c.trim()),localStorage.setItem("donut_use_mock",String(u)),v()},children:"Save settings"})})]})]}),(0,i.jsxs)("section",{className:"card",children:[(0,i.jsxs)("div",{className:"mb-4 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("input",{placeholder:"Search item...",className:"w-64 rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-primary-600",value:e,onChange:e=>t(e.target.value)}),(0,i.jsxs)("select",{className:"rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-primary-600",value:l,onChange:e=>r(e.target.value),children:[(0,i.jsx)("option",{value:"profit",children:"Sort by Profit"}),(0,i.jsx)("option",{value:"roi",children:"Sort by ROI"}),(0,i.jsx)("option",{value:"volume",children:"Sort by Volume"}),(0,i.jsx)("option",{value:"time",children:"Sort by Time to Sell"})]})]}),(0,i.jsx)("div",{className:"text-sm text-muted",children:g?"Loading...":f?"Error: ".concat(f):"".concat(y.length," opportunities")})]}),(0,i.jsx)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:y.map(e=>{var t;return(0,i.jsxs)("article",{className:"rounded-lg border border-white/10 bg-white/5 p-4",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-semibold leading-tight",children:e.itemName}),(0,i.jsx)("p",{className:"text-xs text-muted",children:e.strategyLabel})]}),(0,i.jsxs)("span",{className:"rounded bg-green-500/10 px-2 py-1 text-xs font-semibold text-green-400",children:[Math.round(100*e.roi),"% ROI"]})]}),(0,i.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[(0,i.jsxs)("div",{className:"rounded bg-white/5 p-2",children:[(0,i.jsx)("div",{className:"text-muted text-xs",children:"Buy"}),(0,i.jsxs)("div",{children:["$",(e.buyPrice/1e3).toFixed(2),"k"]})]}),(0,i.jsxs)("div",{className:"rounded bg-white/5 p-2",children:[(0,i.jsx)("div",{className:"text-muted text-xs",children:"Sell"}),(0,i.jsxs)("div",{children:["$",(e.sellPrice/1e3).toFixed(2),"k"]})]}),(0,i.jsxs)("div",{className:"rounded bg-white/5 p-2",children:[(0,i.jsx)("div",{className:"text-muted text-xs",children:"Profit"}),(0,i.jsxs)("div",{children:["$",(e.profit/1e3).toFixed(2),"k"]})]}),(0,i.jsxs)("div",{className:"rounded bg-white/5 p-2",children:[(0,i.jsx)("div",{className:"text-muted text-xs",children:"Volume/day"}),(0,i.jsx)("div",{children:null!==(t=e.estimatedDailyVolume)&&void 0!==t?t:"—"})]})]}),e.notes?(0,i.jsx)("p",{className:"mt-3 text-xs text-muted",children:e.notes}):null]},e.id)})})]})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=8633)}),_N_E=e.O()}]);